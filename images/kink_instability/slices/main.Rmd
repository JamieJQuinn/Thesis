---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.3.3
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import numpy as np
import sdf
import math
import matplotlib
import matplotlib.pyplot as plt
# %matplotlib inline

import importlib
import slice_helper_functions
importlib.reload(slice_helper_functions)
from slice_helper_functions import *
```

# Plot current density slices

```{python active="", eval=FALSE}
# for testing

folder = "/nas/1101974q/archie-latest-organisation-sept-2018/kink-instabilities/initially-unstable/cadence-5-v1e-4r5e-4.5/v1e-4r5e-4.5-isotropic/Data/"

i=15
timedump = '{0:04d}'.format(i)
sdfFilename = folder + timedump + ".sdf"
sdfFile = sdf.read(sdfFilename)
outname = 'isotropic_current_density_' + timedump + '.pdf'
plot_current_density_and_velocity(sdfFile, outname,\
                xLimits=(-1.0, 1.0),yLimits=(0,1.0),\
                                 remove_axes=True)
```

# Specific slices; both; t=13, 15, 20

```{python}
folder = "/nas/1101974q/archie-latest-organisation-sept-2018/kink-instabilities/initially-unstable/cadence-5-v1e-4r5e-4.5/v1e-4r5e-4.5-isotropic/Data/"

for i in [13, 15, 20]:
    timedump = '{0:04d}'.format(i)
    sdfFilename = folder + timedump + ".sdf"
    sdfFile = sdf.read(sdfFilename)
    outname = 'final_isotropic_current_density_' + timedump + '.pdf'
    print(timedump)
    plot_current_density_and_velocity(sdfFile, outname,\
                                      xLimits=(-1, 1),\
                                      yLimits=(0, 1),\
                                      print_maxes=False,\
                                     max_current=3.5,\
                                     max_temperature=90*1e6,\
                                     remove_axes=True)

folder = "/nas/1101974q/archie-latest-organisation-sept-2018/kink-instabilities/initially-unstable/cadence-5-v1e-4r5e-4.5/v1e-4r5e-4.5-switching/Data/"

for i in [13,15, 20]:
    timedump = '{0:04d}'.format(i)
    sdfFilename = folder + timedump + ".sdf"
    sdfFile = sdf.read(sdfFilename)
    outname = 'final_switching_current_density_' + timedump + '.pdf'
    print(timedump)
    plot_current_density_and_velocity(sdfFile, outname,\
                                      xLimits=(-1, 1),\
                                      yLimits=(0, 1),\
                                      print_maxes=False,\
                                     max_current=3.5,\
                                     max_temperature=90*1e6,\
                                     remove_axes=True)
```

# Specific slices; iso; t=25, 30, 35

```{python}
folder = "/nas/1101974q/archie-latest-organisation-sept-2018/kink-instabilities/initially-unstable/cadence-5-v1e-4r5e-4.5/v1e-4r5e-4.5-isotropic/Data/"

for i in [25, 30, 35]:
    timedump = '{0:04d}'.format(i)
    sdfFilename = folder + timedump + ".sdf"
    sdfFile = sdf.read(sdfFilename)
    outname = 'final_isotropic_current_density_' + timedump + '.pdf'
    print(timedump)
    plot_current_density_and_velocity(sdfFile, outname,\
                                      xLimits=(-1.2, 1.2),\
                                      yLimits=(0, 1.2),\
                                      print_maxes=False,\
                                     max_current=3,
                                     max_temperature=85*1e6,\
                                     remove_axes=True)
```

```{python}
folder = "/nas/1101974q/archie-latest-organisation-sept-2018/kink-instabilities/initially-unstable/cadence-5-v1e-4r5e-4.5/v1e-4r5e-4.5-switching/Data/"

for i in [25, 30, 35]:
    timedump = '{0:04d}'.format(i)
    sdfFilename = folder + timedump + ".sdf"
    sdfFile = sdf.read(sdfFilename)
    outname = 'final_switching_current_density_' + timedump + '.pdf'
    print(timedump)
    plot_current_density_and_velocity(sdfFile, outname,\
                                      xLimits=(-1.2, 1.2),\
                                      yLimits=(0, 1.2),\
                                      print_maxes=False,\
                                     max_current=3,
                                     max_temperature=85*1e6,\
                                     remove_axes=True)
```
