---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.3.4
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import numpy as np
import sdf
import math
import matplotlib
import matplotlib.pyplot as plt
# %matplotlib inline

import importlib
import slice_helper_functions
importlib.reload(slice_helper_functions)
from slice_helper_functions import *

data_folder = "/nas/1101974q/archie-latest-organisation-sept-2018/null-point-stressing/"
parameter_study_folder = "/twisting-driver/parameter-study/"
```

```{python}
def plot_entire_parameter_study(variable_name, slice_dim, slice_loc, xlim=False, ylim=False):
    visc_range = [3, 4, 5]
    resist_range = [3, 4, 5]

    for i in range(1, 16):
        timedump = '{0:04d}'.format(i)
        for visc in visc_range:
            for resist in resist_range:
                for model in ["isotropic", "switching"]:
                    run_folder = "v-" + str(visc) + "r-" + str(resist) + "-" + model
                    folder = data_folder + parameter_study_folder + run_folder + "/Data/"
                    sdfFilename = folder + timedump + ".sdf"

                    outname = run_folder + "_" + variable_name + "_" + slice_dim + "_" + str(slice_loc) + "_" + timedump
                    plot_slice(sdfFilename, variable_name, slice_dim, slice_loc, title=outname, xlim=xlim, ylim=ylim)

                    save_plot(outname + ".pdf")
```

# Plot velocity slices showing presence of instability in Vz

```{python}
run_folder = "v-4r-4-isotropic"
folder = data_folder + parameter_study_folder + run_folder + "/Data/"
i=8
timedump = '{0:04d}'.format(i)
sdfFilename = folder + timedump + ".sdf"

sdfFile = sdf.read(sdfFilename)

vx = get_variable(sdfFile, "Magnetic_Field_Bx")
print(sdfFile.Grid_Grid.dims)
```

```{python}
run_folder = "v-4r-4-switching"
folder = data_folder + parameter_study_folder + run_folder + "/Data/"
i=6
timedump = '{0:04d}'.format(i)
sdfFilename = folder + timedump + ".sdf"

plot_slice(sdfFilename, "vorticity_density", "x", 0.85, xlim=(-1.0, 1.0), ylim=(-0.25, 0.25))
```

```{python}
# for variable in ["Velocity_Vz", "vorticity_density", "magnitude_current_density", "Fluid_Energy"]:
for variable in ["magnitude_current_density", "vorticity_density"]:
    plot_entire_parameter_study(variable, "z", 0.0)
```

# Plot slices in x

```{python}
run_folder = "v-4r-3-switching"
folder = data_folder + parameter_study_folder + run_folder + "/Data/"
i=7
timedump = '{0:04d}'.format(i)
sdfFilename = folder + timedump + ".sdf"

plot_slice(sdfFilename, "Velocity_Vz", "x", 0.85, xlim=(-0.5, 0.5), ylim=(-0.1, 0.1))
```

```{python}
for variable in ["Velocity_Vx", "vorticity_density", "magnitude_current_density", "Fluid_Energy"]:
    plot_entire_parameter_study(variable, "x", 0.0, xlim=(-1.0, 1.0), ylim=(-0.25, 0.25))
```

```{python}
for variable in ["Velocity_Vz", "vorticity_density", "magnitude_current_density", "Velocity_Vy", "Fluid_Energy"]:
    plot_entire_parameter_study(variable, "x", 0.85, xlim=(-0.5, 0.5), ylim=(-0.1, 0.1))
```
